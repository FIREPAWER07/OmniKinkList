<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KinkList - Modern Preference Explorer</title>
    <style>
        /* CSS Variables for theming */
        :root {
            --background: #ffffff;
            --foreground: #0a0a0a;
            --card: #ffffff;
            --card-foreground: #0a0a0a;
            --primary: #18181b;
            --primary-foreground: #fafafa;
            --secondary: #f4f4f5;
            --secondary-foreground: #18181b;
            --muted: #f4f4f5;
            --muted-foreground: #71717a;
            --border: #e4e4e7;
            --input: #e4e4e7;
            --ring: #a1a1aa;
            
            /* Preference colors */
            --color-favorite: #3b82f6;
            --color-like: #10b981;
            --color-indifferent: #f59e0b;
            --color-maybe: #f97316;
            --color-limit: #dc2626;
            --color-not-entered: #e2e8f0;
        }

        .dark {
            --background: #0a0a0a;
            --foreground: #fafafa;
            --card: #0a0a0a;
            --card-foreground: #fafafa;
            --primary: #fafafa;
            --primary-foreground: #18181b;
            --secondary: #27272a;
            --secondary-foreground: #fafafa;
            --muted: #27272a;
            --muted-foreground: #a1a1aa;
            --border: #27272a;
            --input: #27272a;
            --ring: #52525b;
            
            --color-favorite: #60a5fa;
            --color-like: #34d399;
            --color-indifferent: #fbbf24;
            --color-maybe: #fb923c;
            --color-limit: #f87171;
            --color-not-entered: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background);
            color: var(--foreground);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
            border-radius: 16px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
            align-items: center;
            justify-content: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: var(--secondary-foreground);
        }

        .btn-secondary:hover {
            opacity: 0.9;
        }

        .list-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .list-type-btn {
            padding: 12px 24px;
            border: 2px solid var(--border);
            background: var(--card);
            color: var(--card-foreground);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .list-type-btn:hover {
            border-color: var(--primary);
        }

        .list-type-btn.active {
            background: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }

        .category {
            margin-bottom: 40px;
            background: var(--card);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border);
        }

        .category-header {
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--foreground);
        }

        .category-description {
            color: var(--muted-foreground);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .subcategory {
            margin-bottom: 20px;
        }

        .subcategory-title {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 12px;
            color: var(--muted-foreground);
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .kink-item {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            transition: all 0.2s;
        }

        .kink-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .item-name {
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--foreground);
        }

        .item-description {
            font-size: 0.85rem;
            color: var(--muted-foreground);
            margin-bottom: 12px;
        }

        .preference-buttons {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .dual-preferences {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .dual-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--muted-foreground);
        }

        .pref-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
            opacity: 0.7;
        }

        .pref-btn:hover {
            opacity: 1;
            transform: scale(1.05);
        }

        .pref-btn.active {
            opacity: 1;
            transform: scale(1.1);
        }

        .pref-favorite { background-color: var(--color-favorite); color: white; }
        .pref-like { background-color: var(--color-like); color: white; }
        .pref-indifferent { background-color: var(--color-indifferent); color: white; }
        .pref-maybe { background-color: var(--color-maybe); color: white; }
        .pref-limit { background-color: var(--color-limit); color: white; }
        .pref-not-entered { background-color: var(--color-not-entered); color: var(--foreground); }

        .progress-bar {
            background: var(--secondary);
            border-radius: 8px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--color-favorite), var(--color-like));
            height: 100%;
            transition: width 0.3s ease;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat {
            text-align: center;
            padding: 12px;
            background: var(--card);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--foreground);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--muted-foreground);
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.2s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .hidden {
            display: none;
        }

        .completion-page {
            text-align: center;
            padding: 40px 20px;
        }

        .completion-title {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--foreground);
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .items-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .list-selector {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <span id="theme-icon">🌙</span>
    </button>

    <div class="container">
        <!-- List Selection Page -->
        <div id="list-selection" class="page">
            <div class="header">
                <h1>KinkList - Modern Preference Explorer</h1>
                <p>A modern, accessible tool for exploring and expressing your preferences</p>
            </div>

            <div class="controls">
                <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importPreferences(event)">
                <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">
                    Import JSON
                </button>
            </div>

            <div class="category">
                <h2 class="category-title">Choose Your List Type</h2>
                <p class="category-description">Select the version that best fits your needs</p>
                
                <div class="list-selector">
                    <button class="list-type-btn" onclick="selectListType('classic')">
                        <strong>Classic</strong><br>
                        <small>Simple, essential categories</small>
                    </button>
                    <button class="list-type-btn" onclick="selectListType('detailed')">
                        <strong>Detailed</strong><br>
                        <small>Comprehensive with descriptions</small>
                    </button>
                    <button class="list-type-btn" onclick="selectListType('extended')">
                        <strong>Extended</strong><br>
                        <small>Complete with all options</small>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Kinklist Page -->
        <div id="kinklist-page" class="page hidden">
            <div class="header">
                <h1>Your Kinklist</h1>
                <p>Select your preferences for each item</p>
            </div>

            <div class="controls">
                <button class="btn btn-secondary" onclick="showListSelection()">← Back to List Selection</button>
                <button class="btn btn-secondary" onclick="resetAll()">Reset All</button>
                <button class="btn btn-primary" onclick="showCompletion()">Complete & Export</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="total-items">0</div>
                    <div class="stat-label">Total Items</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="completed-items">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="completion-percentage">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>

            <div id="categories-container"></div>
        </div>

        <!-- Completion Page -->
        <div id="completion-page" class="page hidden">
            <div class="completion-page">
                <h1 class="completion-title">🎉 Kinklist Complete!</h1>
                <p>Your preferences have been saved. You can now export your kinklist.</p>
                
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportAsJSON()">Export as JSON</button>
                    <button class="btn btn-primary" onclick="exportAsHTML()">Export as HTML</button>
                </div>

                <div class="controls">
                    <button class="btn btn-secondary" onclick="showKinklist()">← Back to Edit</button>
                    <button class="btn btn-secondary" onclick="showListSelection()">Start Over</button>
                </div>

                <div id="completion-stats"></div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentListType = null;
        let preferences = {};
        let kinkData = [];

        // Category explanations
        const categoryExplanations = {
            "Bodies": "Physical attributes and body type preferences, including size preferences for various body parts.",
            "Clothing": "Attire, garments, and dress-up preferences that enhance or are part of sexual scenarios.",
            "Roles & Dynamics": "Character roles, gender expressions, and power dynamics in sexual scenarios.",
            "Group Scenarios": "Partner configurations and group dynamics for sexual encounters.",
            "General": "Basic sexual activities, romantic interactions, and fundamental intimate acts.",
            "Ass play": "Activities focused on anal stimulation, penetration, and related practices.",
            "Restrictive": "Bondage, restraints, and activities that limit movement or control.",
            "Toys": "Sex toys, devices, and implements used for sexual stimulation and play.",
            "Domination": "Power exchange dynamics, control scenarios, and dominance/submission activities.",
            "No consent": "Fantasy scenarios involving non-consensual elements (fantasy only, not real consent violations).",
            "Taboo": "Socially forbidden or unconventional scenarios and relationship dynamics.",
            "Fluids": "Activities involving various bodily fluids and related fetishes.",
            "Degradation": "Humiliation, verbal abuse, and activities focused on psychological dominance.",
            "Touch & Stimulation": "Various forms of physical contact, sensation play, and stimulation techniques.",
            "Misc. Fetish": "Diverse fetishes and kinks that don't fit into other specific categories.",
            "Pain": "Activities involving physical discomfort, impact play, and pain-based stimulation.",
            "Meta": "Roleplay preferences, writing styles, and communication preferences for scenes.",
            "Surrealism": "Fantasy elements, supernatural scenarios, and non-realistic character types.",
            "Medium": "Communication platforms and methods for engaging in roleplay or sexual communication.",
            "Time-Scale": "Response timing expectations and scene duration preferences for roleplay."
        };

        // Kinklist data (embedded)
        const kinklistData = {
            classic: `#Bodies
(General)
* Skinny
* Chubby
* Muscular
* Curvy

#Clothing
(Self, Partner)
* Clothed sex
* Lingerie
* Stockings
* Heels
* Leather
* Latex
* Uniform / costume
* Cross-dressing

#Roles & Groupings
* as Male
* as Female
* as Dominant
* as Submissive
* as Switch
* You and 1 male
* You and 1 female
* You and 2 males
* You and 2 females
* Orgy

#General
* Romance / Affection
* Handjob / Fingering
* Blowjob
* Deep throat
* Swallowing
* Facials
* Cunnilingus
* Face-sitting
* Edging
* Teasing
* Mutual masturbation
* 69
* Kissing
* Making out

#Ass play
* Anal toys
* Anal sex/pegging
* Rimming
* Double penetration
* Anal fisting

#Restrictive
* Gag
* Collar
* Leash
* Chastity
* Bondage (Light)
* Bondage (Heavy)
* Rope bondage
* Handcuffs

#Toys
* Dildos
* Plugs
* Vibrators
* Cock rings

#Domination
* General Dom / General Sub
* Domestic servitude
* Slavery
* Pet play
* DD/lg, MD/lb
* Discipline
* Begging
* Forced orgasm
* Orgasm control
* Orgasm denial
* Power exchange
* Worship

#No consent
* Dubious consent
* Non-con / rape
* Blackmail / coercion
* Kidnapping
* Drugs
* Alcohol
* Sleep play

#Taboo
* Incest
* Age Gap
* Interracial
* Raceplay
* Bestiality
* Necrophilia
* Cheating
* Exhibitionism
* Voyeurism
* Public sex

#Fluids
* Blood
* Watersports
* Scat
* Lactation
* Cum play
* Saliva/Spit
* Squirting

#Degradation
* Glory hole
* Name calling
* Humiliation
* Verbal abuse
* Public humiliation

#Touch & Stimulation
* Cock/Pussy worship
* Ass worship
* Foot play
* Tickling
* Sensation play
* Massage

#Misc. Fetish
* Fisting
* Gangbang
* Breath play
* Impregnation
* Pregnancy
* Feminization
* Cuckold / Cuckquean
* Shaving
* Medical play
* Age play

#Pain
* Light pain
* Heavy pain
* Nipple clamps
* Clothes pins
* Caning
* Flogging
* Gagging / Choking
* Beating
* Spanking
* Cock/Pussy slapping
* Cock/Pussy torture
* Hot Wax
* Scratching
* Biting
* Cutting
* Needle play`,

            detailed: `#Bodies
(General)
* Skinny
? Expresses an interest in characters that are waifish, thin, or slender.
* Chubby
? Expresses an interest in characters that are well-rounded, full in form, and pudgy.
* Small breasts
? Expresses an interest in breasts that are particularly small, sometimes to the point of appearing absent.
* Large breasts
? Expresses an interest in breasts that are particularly large.
* Small cocks
? Expresses an interest in cocks that are below average size.
* Large cocks
? Expresses an interest in cocks that are above average size.
* Small butts
? Expresses an interest in butts that are particularly small.
* Big Butts
? Expresses an interest in butts that are particularly large.
* Muscular
? Expresses an interest in well-defined, athletic physiques.
* Curvy
? Expresses an interest in pronounced body curves and fuller figures.

#Clothing
(Self, Partner)
* Clothed sex
? Engaging in sexual activity while you and/or your partner remain partially or fully dressed.
* Lingerie
? Expresses an interest in the inclusion of lingerie in sexual contexts.
* Stockings
? Expresses an interest in the inclusion of stockings in sexual contexts.
* Heels
? Expresses an interest in the inclusion of high heeled shoes in sexual contexts.
* Leather
? Expresses an interest in the inclusion of leather clothing in sexual contexts.
* Latex
? The usage of latex and/or rubber material worn as clothing.
* Uniform / costume
? Expresses an interest in the inclusion of uniforms or costumes in sexual contexts.
* Cross-dressing
? Engaging in scenarios where one or more participants dress in clothes typically associated with a different gender.
* Corsets
? Structured undergarments that shape and support the torso.
* Boots
? Interest in boots as part of sexual play or aesthetic.

#Roles & Dynamics
(General)
* Playing as Male
? Taking on the role of a male character in sexual scenarios.
* Playing as Female
? Taking on the role of a female character in sexual scenarios.
* Playing as Femboy
? Taking on the role of a feminine male character.
* Playing as Futa
? Taking on the role of a character with both male and female characteristics.
* Playing as MtF trans
? Taking on the role of a male-to-female transgender character.
* Playing as FtM trans
? Taking on the role of a female-to-male transgender character.
* Playing as Celebrity
? Role-playing as famous personalities or public figures.
* Being Dominant
? Taking control and leading sexual encounters and dynamics.
* Being Submissive
? Following commands and being led in sexual encounters and dynamics.
* Being a Switch
? Alternating between dominant and submissive roles depending on the situation.

#Group Scenarios
(General)
* One-on-One (Male Partner)
? Sexual scenarios involving you and one male partner.
* One-on-One (Female Partner)
? Sexual scenarios involving you and one female partner.
* One-on-One (MtF Trans Partner)
? Sexual scenarios involving you and one male-to-female transgender partner.
* One-on-One (FtM Trans Partner)
? Sexual scenarios involving you and one female-to-male transgender partner.
* Threesome (?MF)
? Sexual scenarios involving you one male, and one female.
* Threesome (?MM)
? Sexual scenarios involving you and two males.
* Threesome (?FF)
? Sexual scenarios involving you and two females.
* Group Sex / Orgy
? Sexual scenarios involving multiple participants of various genders.

#General
(Giving, Receiving)
* Romance / Affection
? Displaying or expressing love or strong affection, passion, either during intimate moments or during normal interactions.
* Handjob / Fingering
? Sexual stimulation by direct, physical contact of the hands or fingers to the genitals.
* Blowjob
? Sexual stimulation by direct, physical contact of the mouth or tongue to male genitals.
* Deep throat
? The act of oral penetration to the depths where it enters the back of the mouth cavity and/or throat.
* Swallowing
? The act of orally consuming semen, either directly or indirectly.
* Facials
? The act of ejaculating directly onto one's face.
* Cunnilingus
? Sexual stimulation by direct, physical contact of the mouth or tongue to female genitals.
* Face-sitting
? A sexual practice where someone sits on another's face with their buttocks or genitals.
* Edging
? Keeping on the edge of climax without reaching orgasm.
* Teasing
? Extended scenes of foreplay prior to explicit sexual activity, which may be physical and/or verbal.
* Mutual masturbation
? Partners stimulating themselves while watching each other.
* 69
? Simultaneous oral stimulation between partners where both give and receive.
* Kissing
? Intimate lip contact and tongue play between partners.
* Making out
? Extended passionate kissing and intimate touching.

#Ass play
(Giving, Receiving)
* Anal toys
? The inclusion of anal penetration with sex toys, including dildos, vibrators, anal beads, etc.
* Anal sex/pegging
? Being penetrated by a partner, with a penis or strap-on.
* Rimming
? The act of giving oral stimulation to a partner's anus.
* Double penetration
? The act of penetrating multiple orifices simultaneously.
* Anal fisting
? The act of inserting one's hand(s) and/or arm(s) into one's partner's anus.
* Anal training
? Gradual preparation and stretching for anal activities.

#Restrictive
(Self, Partner)
* Gag
? The act of placing an object in someone's mouth to restrict speech and breathing.
* Collar
? Wearing a collar around the neck as a symbol of submission or aesthetic choice.
* Leash
? Being led around on a leash, often in conjunction with collar play.
* Chastity
? Sexual abstinence, either willing or forced, sometimes involving devices that prevent sexual activity.
* Bondage (Light)
? The use of restraints that are mild or moderate in intensity and duration.
* Bondage (Heavy)
? The use of restraints that are extreme in position, duration, discomfort, or immobilization.
* Encasement
? Having one's whole body wrapped up in latex, sleepsacks, or other restrictive materials.
* Rope bondage
? The art of restraining using rope in decorative and functional patterns.
* Handcuffs
? Metal restraints typically used on wrists or ankles.

#Toys
(Self, Partner)
* Dildos
? Objects shaped like genitals used for sexual stimulation.
* Plugs
? Sex toys designed to be inserted and remain in place.
* Vibrators
? Vibrating devices used for sexual stimulation.
* Sounding
? The act of inserting smooth rods into the urethra.
* Cock rings
? Rings worn around the base of the penis to maintain erection.
* Ben wa balls
? Small weighted balls inserted vaginally for stimulation.

#Domination
(As Dominant, As Submissive)
* General Dom / General Sub
? Catchall for Dominant/Submissive activities and dynamics.
* Domestic servitude
? Being served by or serving as a butler, maid, or other service role.
* Slavery
? Serving at someone's complete command without choice in the matter.
* Pet play
? Role play where the focus is on entering the mindset of a different species.
* DD/lg, MD/lb
? Daddy/Mommy Dom and Little Girl/Boy dynamics focusing on care and guidance.
* Discipline
? The use of rewards and punishments to train obedience to commands.
* Begging
? The act of pleading as a form of submission.
* Forced orgasm
? Consensual play where a person is made to orgasm beyond their control.
* Orgasm control
? The dominant controlling when the submissive achieves orgasm.
* Orgasm denial
? The dominant denying the submissive orgasm entirely.
* Power exchange
? A relationship dynamic with service and control at its core.
* Worship
? Showing reverence and adoration for a partner or specific body parts.

#No consent
(Aggressor, Target)
* Dubious consent
? Situations where one partner's consent is questionable though not outright refused.
* Non-con / rape
? Taking or being taken against one's will, often through force (fantasy only).
* Blackmail / coercion
? Using threats or pressure to obtain sexual compliance.
* Kidnapping
? The act of abducting someone for sexual purposes (fantasy only).
* Drugs
? The use of substances to alter mental state in sexual contexts.
* Alcohol
? The use of alcohol to lower inhibitions or alter mental state.
* Sleep play
? Engaging in sexual acts with an unconscious or sleeping partner.
* Intoxication play
? Sexual activity while under the influence of substances.

#Taboo
(General)
* Incest
? Sexual activity between family members (fantasy only).
* Age Gap
? Significant differences in age between partners (all participants adult).
* Interracial
? Sexual interactions between people of different races without relying on stereotypes.
* Raceplay
? Sexual scenarios that incorporate racial elements or stereotypes.
* Bestiality
? Sexual activity with animals (fantasy only).
* Necrophilia
? Sexual activity with the deceased (fantasy only).
* Cheating
? Infidelity scenarios where one or both partners are unfaithful.
* Exhibitionism
? Sexual activity in public or semi-public settings.
* Voyeurism
? Deriving sexual pleasure from watching others in intimate situations.
* Public sex
? Sexual activity in public spaces with risk of being seen.

#Fluids
(General)
* Blood
? The inclusion of blood in sexual contexts.
* Watersports
? The inclusion of urine in sexual activities.
* Scat
? The inclusion of fecal matter in sexual activities.
* Lactation
? The production and consumption of breast milk in sexual contexts.
* Diapers
? Sexual scenarios involving the wearing of diapers.
* Cum play
? Various activities focused on semen.
* Saliva/Spit
? Sexual play involving saliva or spitting.
* Squirting
? Female ejaculation during sexual activity.

#Degradation
(Giving, Receiving)
* Glory hole
? Sexual activity through a barrier with anonymous partners.
* Name calling
? Using derogatory terms as part of sexual play.
* Humiliation
? Causing embarrassment as a form of sexual gratification.
* Verbal abuse
? Using harsh language as part of sexual dynamics.
* Public humiliation
? Embarrassment in front of others as part of sexual play.

#Touch & Stimulation
(Actor, Subject)
* Cock/Pussy worship
? Focused attention and reverence for genitalia.
* Ass worship
? Focused attention and reverence for buttocks.
* Foot play
? Incorporating feet into sexual activities.
* Tickling
? Using tickling as a form of sexual stimulation.
* Sensation play
? Using various sensations to arouse and stimulate.
* Electro stimulation
? Using electrical current for sexual stimulation.
* Temperature play
? Using hot and cold sensations for sexual stimulation.
* Massage
? Therapeutic and sensual touching for relaxation and arousal.

#Misc. Fetish
(Giving, Receiving)
* Fisting
? Inserting a hand or fist into body cavities.
* Gangbang
? Multiple partners engaging with a single person.
* Breath play
? Controlling breathing for sexual enhancement.
* Impregnation
? The fantasy or act of causing pregnancy.
* Pregnancy
? Sexual attraction to pregnant individuals.
* Feminization
? Making someone adopt traditionally feminine characteristics.
* Cuckold / Cuckquean
? Watching one's partner with someone else.
* Shaving
? Removing body hair as part of sexual play.
* Medical play
? Role playing medical scenarios and procedures.
* Age play
? Role playing different ages (all participants adult).

#Pain
(Giving, Receiving)
* Light pain
? Mild physical discomfort for sexual enhancement.
* Heavy pain
? Intense physical discomfort for sexual enhancement.
* Nipple clamps
? Devices that apply pressure to nipples.
* Clothes pins
? Using clothespins to pinch skin.
* Caning
? Striking with a flexible cane.
* Flogging
? Striking with whips, floggers, or similar implements.
* Gagging / Choking
? Restricting breathing or causing gag reflex.
* Beating
? Striking with fists or objects.
* Spanking
? Striking the buttocks for sexual pleasure.
* Cock/Pussy slapping
? Striking genitalia for sexual stimulation.
* Cock/Pussy torture
? Causing pain to genitalia for sexual purposes.
* Hot Wax
? Using heated wax for sexual stimulation.
* Scratching
? Using nails or claws to mark skin.
* Biting
? Using teeth to cause sensation or pain.
* Cutting
? Making small cuts for sexual purposes.
* Needle play
? Using needles for sensation or pain.

#Meta
(Self, Partner)
* First Person
* Third Person
* Short Post Length (~1-3 sentences)
* Medium Post Length (~3-7 sentences)
* Long Post Length (~2-4 paragraphs)
* Story (3+ paragraphs)
* Dynamic Post Length

#Surrealism
(Self, Partner)
* Futanari/Futa
? characters who have an overall feminine body, but have both female and male genitalia (although testicles are not always present)
* Furry
? Anthropomorphic animal characters.
* Vore
? The act of physically consuming another character
* Transformation
? The act of causing the physical characteristics of a participant of an RP, possibly including one's self, by magical or chemical means, to change in a dramatic fashion; may refer to a myriad of different types of transformations, and connotates receiving sexual pleasure from the act of transformation itself.
* Tentacles
? Engaging in an RP in which self-sentient tentacles or tentacle-like appendages will penetrate a character; often implies multiple penetration.
* Monster or Alien
? Various types of monsters, Extraterrestrials, and aesthetically challenging characters.
* Ghost
? The formerly living, not currently in posession of a body
* Shapeshifting
? Characters with the ability to change their physical form at will, including species, gender, or body parts.
* Size Play (Macro/Micro)
? Scenarios involving dramatic size differences between characters, from giant to tiny proportions.
* Multiple Limbs
? Characters with additional arms, legs, or other appendages beyond normal human anatomy.
* Elemental Beings
? Characters made of or controlling elements like fire, water, earth, air, or other natural forces.
* Cyborgs/Androids
? Characters that are part machine, artificial intelligence, or robotic beings with human-like qualities.
* Vampires/Supernatural
? Immortal beings, vampires, werewolves, and other classic supernatural creatures.
* Mythical Creatures
? Dragons, phoenixes, unicorns, and other creatures from mythology and fantasy.
* Plant/Nature Beings
? Characters that are plant-based, tree-like, or have botanical characteristics.
* Energy Beings
? Characters made of pure energy, light, or other non-physical substances.

#Medium
(General)
* Skype
* Kik
* Reddit
* E-Mail
* Discord
* Other
* Telegram
? Secure messaging platform with advanced features for private communication.
* WhatsApp
? Popular mobile messaging application for text and voice communication.
* Signal
? Privacy-focused messaging app with end-to-end encryption.
* Steam
? Gaming platform with built-in messaging and chat features.
* Twitter/X DMs
? Direct messaging through Twitter/X social media platform.
* Instagram DMs
? Direct messaging through Instagram social media platform.
* Snapchat
? Mobile app focused on disappearing messages and multimedia sharing.
* Facebook Messenger
? Facebook's dedicated messaging platform for text and video communication.
* Forums/Boards
? Traditional forum-style communication with threaded discussions.
* Custom Platforms
? Specialized roleplay websites and custom communication tools.

#Time-Scale
(Self, Partner)
* Short-Term Scenes
* Medium-Term Scenes
* Long-Term Scenes
* Ultra-Quick Replies (0~5 mins)
? Immediate responses expected within minutes for rapid-fire roleplay.
* Quick Replies (0~10 mins)
* Fast Replies (10~30 mins)
* Normal Replies (30min ~ 2hours)
* Slow Replies (2~8 hours)
* Glacial Replies (8-24 hours)
* Occasional Replies (24+ hours)
* Weekly Replies (1~7 days)
? Responses expected within a week, suitable for detailed, thoughtful posts.
* Monthly Replies (Weeks to months)
? Very slow-paced roleplay with responses every few weeks to months.
* Seasonal Replies (Months between)
? Extremely slow-paced with responses separated by months, for epic long-term stories.
* Real-time Sessions
? Live, synchronous roleplay sessions with immediate back-and-forth interaction.
* Flexible Timing
? No set expectations, responses when convenient for both parties.`,

            extended: `#Bodies
(General)
* Skinny
? Expresses an interest in characters that are waifish, thin, or slender.
* Chubby
? Expresses an interest in characters that are well-rounded, full in form, and pudgy.
* Small breasts
? Expresses an interest in breasts that are particularly small, sometimes to the point of appearing absent.
* Large breasts
? Expresses an interest in breasts that are particularly large.
* Small cocks
? Expresses an interest in cocks that are below average size.
* Large cocks
? Expresses an interest in cocks that are above average size.
* Small butts
? Expresses an interest in butts that are particularly small.
* Big Butts
? Expresses an interest in butts that are particularly large.
* Muscular
? Expresses an interest in well-defined, athletic physiques.
* Curvy
? Expresses an interest in pronounced body curves and fuller figures.

#Clothing
(Self, Partner)
* Clothed sex
? Engaging in sexual activity while you and/or your partner remain partially or fully dressed.
* Lingerie
? Expresses an interest in the inclusion of lingerie in sexual contexts.
* Stockings
? Expresses an interest in the inclusion of stockings in sexual contexts.
* Heels
? Expresses an interest in the inclusion of high heeled shoes in sexual contexts.
* Leather
? Expresses an interest in the inclusion of leather clothing in sexual contexts.
* Latex
? The usage of latex and/or rubber material worn as clothing.
* Uniform / costume
? Expresses an interest in the inclusion of uniforms or costumes in sexual contexts.
* Cross-dressing
? Engaging in scenarios where one or more participants dress in clothes typically associated with a different gender.
* Corsets
? Structured undergarments that shape and support the torso.
* Boots
? Interest in boots as part of sexual play or aesthetic.

#Roles & Dynamics
(General)
* Playing as Male
? Taking on the role of a male character in sexual scenarios.
* Playing as Female
? Taking on the role of a female character in sexual scenarios.
* Playing as Femboy
? Taking on the role of a feminine male character.
* Playing as Futa
? Taking on the role of a character with both male and female characteristics.
* Playing as MtF trans
? Taking on the role of a male-to-female transgender character.
* Playing as FtM trans
? Taking on the role of a female-to-male transgender character.
* Playing as Celebrity
? Role-playing as famous personalities or public figures.
* Being Dominant
? Taking control and leading sexual encounters and dynamics.
* Being Submissive
? Following commands and being led in sexual encounters and dynamics.
* Being a Switch
? Alternating between dominant and submissive roles depending on the situation.

#Group Scenarios
(General)
* One-on-One (Male Partner)
? Sexual scenarios involving you and one male partner.
* One-on-One (Female Partner)
? Sexual scenarios involving you and one female partner.
* One-on-One (MtF Trans Partner)
? Sexual scenarios involving you and one male-to-female transgender partner.
* One-on-One (FtM Trans Partner)
? Sexual scenarios involving you and one female-to-male transgender partner.
* Threesome (?MF)
? Sexual scenarios involving you one male, and one female.
* Threesome (?MM)
? Sexual scenarios involving you and two males.
* Threesome (?FF)
? Sexual scenarios involving you and two females.
* Group Sex / Orgy
? Sexual scenarios involving multiple participants of various genders.

#General
(Giving, Receiving)
* Romance / Affection
? Displaying or expressing love or strong affection, passion, either during intimate moments or during normal interactions.
* Handjob / Fingering
? Sexual stimulation by direct, physical contact of the hands or fingers to the genitals.
* Blowjob
? Sexual stimulation by direct, physical contact of the mouth or tongue to male genitals.
* Deep throat
? The act of oral penetration to the depths where it enters the back of the mouth cavity and/or throat.
* Swallowing
? The act of orally consuming semen, either directly or indirectly.
* Facials
? The act of ejaculating directly onto one's face.
* Cunnilingus
? Sexual stimulation by direct, physical contact of the mouth or tongue to female genitals.
* Face-sitting
? A sexual practice where someone sits on another's face with their buttocks or genitals.
* Edging
? Keeping on the edge of climax without reaching orgasm.
* Teasing
? Extended scenes of foreplay prior to explicit sexual activity, which may be physical and/or verbal.
* Mutual masturbation
? Partners stimulating themselves while watching each other.
* 69
? Simultaneous oral stimulation between partners where both give and receive.
* Kissing
? Intimate lip contact and tongue play between partners.
* Making out
? Extended passionate kissing and intimate touching.

#Ass play
(Giving, Receiving)
* Anal toys
? The inclusion of anal penetration with sex toys, including dildos, vibrators, anal beads, etc.
* Anal sex/pegging
? Being penetrated by a partner, with a penis or strap-on.
* Rimming
? The act of giving oral stimulation to a partner's anus.
* Double penetration
? The act of penetrating multiple orifices simultaneously.
* Anal fisting
? The act of inserting one's hand(s) and/or arm(s) into one's partner's anus.
* Anal training
? Gradual preparation and stretching for anal activities.

#Restrictive
(Self, Partner)
* Gag
? The act of placing an object in someone's mouth to restrict speech and breathing.
* Collar
? Wearing a collar around the neck as a symbol of submission or aesthetic choice.
* Leash
? Being led around on a leash, often in conjunction with collar play.
* Chastity
? Sexual abstinence, either willing or forced, sometimes involving devices that prevent sexual activity.
* Bondage (Light)
? The use of restraints that are mild or moderate in intensity and duration.
* Bondage (Heavy)
? The use of restraints that are extreme in position, duration, discomfort, or immobilization.
* Encasement
? Having one's whole body wrapped up in latex, sleepsacks, or other restrictive materials.
* Rope bondage
? The art of restraining using rope in decorative and functional patterns.
* Handcuffs
? Metal restraints typically used on wrists or ankles.

#Toys
(Self, Partner)
* Dildos
? Objects shaped like genitals used for sexual stimulation.
* Plugs
? Sex toys designed to be inserted and remain in place.
* Vibrators
? Vibrating devices used for sexual stimulation.
* Sounding
? The act of inserting smooth rods into the urethra.
* Cock rings
? Rings worn around the base of the penis to maintain erection.
* Ben wa balls
? Small weighted balls inserted vaginally for stimulation.

#Domination
(As Dominant, As Submissive)
* General Dom / General Sub
? Catchall for Dominant/Submissive activities and dynamics.
* Domestic servitude
? Being served by or serving as a butler, maid, or other service role.
* Slavery
? Serving at someone's complete command without choice in the matter.
* Pet play
? Role play where the focus is on entering the mindset of a different species.
* DD/lg, MD/lb
? Daddy/Mommy Dom and Little Girl/Boy dynamics focusing on care and guidance.
* Discipline
? The use of rewards and punishments to train obedience to commands.
* Begging
? The act of pleading as a form of submission.
* Forced orgasm
? Consensual play where a person is made to orgasm beyond their control.
* Orgasm control
? The dominant controlling when the submissive achieves orgasm.
* Orgasm denial
? The dominant denying the submissive orgasm entirely.
* Power exchange
? A relationship dynamic with service and control at its core.
* Worship
? Showing reverence and adoration for a partner or specific body parts.

#No consent
(Aggressor, Target)
* Dubious consent
? Situations where one partner's consent is questionable though not outright refused.
* Non-con / rape
? Taking or being taken against one's will, often through force (fantasy only).
* Blackmail / coercion
? Using threats or pressure to obtain sexual compliance.
* Kidnapping
? The act of abducting someone for sexual purposes (fantasy only).
* Drugs
? The use of substances to alter mental state in sexual contexts.
* Alcohol
? The use of alcohol to lower inhibitions or alter mental state.
* Sleep play
? Engaging in sexual acts with an unconscious or sleeping partner.
* Intoxication play
? Sexual activity while under the influence of substances.

#Taboo
(General)
* Incest
? Sexual activity between family members (fantasy only).
* Age Gap
? Significant differences in age between partners (all participants adult).
* Interracial
? Sexual interactions between people of different races without relying on stereotypes.
* Raceplay
? Sexual scenarios that incorporate racial elements or stereotypes.
* Bestiality
? Sexual activity with animals (fantasy only).
* Necrophilia
? Sexual activity with the deceased (fantasy only).
* Cheating
? Infidelity scenarios where one or both partners are unfaithful.
* Exhibitionism
? Sexual activity in public or semi-public settings.
* Voyeurism
? Deriving sexual pleasure from watching others in intimate situations.
* Public sex
? Sexual activity in public spaces with risk of being seen.

#Fluids
(General)
* Blood
? The inclusion of blood in sexual contexts.
* Watersports
? The inclusion of urine in sexual activities.
* Scat
? The inclusion of fecal matter in sexual activities.
* Lactation
? The production and consumption of breast milk in sexual contexts.
* Diapers
? Sexual scenarios involving the wearing of diapers.
* Cum play
? Various activities focused on semen.
* Saliva/Spit
? Sexual play involving saliva or spitting.
* Squirting
? Female ejaculation during sexual activity.

#Degradation
(Giving, Receiving)
* Glory hole
? Sexual activity through a barrier with anonymous partners.
* Name calling
? Using derogatory terms as part of sexual play.
* Humiliation
? Causing embarrassment as a form of sexual gratification.
* Verbal abuse
? Using harsh language as part of sexual dynamics.
* Public humiliation
? Embarrassment in front of others as part of sexual play.

#Touch & Stimulation
(Actor, Subject)
* Cock/Pussy worship
? Focused attention and reverence for genitalia.
* Ass worship
? Focused attention and reverence for buttocks.
* Foot play
? Incorporating feet into sexual activities.
* Tickling
? Using tickling as a form of sexual stimulation.
* Sensation play
? Using various sensations to arouse and stimulate.
* Electro stimulation
? Using electrical current for sexual stimulation.
* Temperature play
? Using hot and cold sensations for sexual stimulation.
* Massage
? Therapeutic and sensual touching for relaxation and arousal.

#Misc. Fetish
(Giving, Receiving)
* Fisting
? Inserting a hand or fist into body cavities.
* Gangbang
? Multiple partners engaging with a single person.
* Breath play
? Controlling breathing for sexual enhancement.
* Impregnation
? The fantasy or act of causing pregnancy.
* Pregnancy
? Sexual attraction to pregnant individuals.
* Feminization
? Making someone adopt traditionally feminine characteristics.
* Cuckold / Cuckquean
? Watching one's partner with someone else.
* Shaving
? Removing body hair as part of sexual play.
* Medical play
? Role playing medical scenarios and procedures.
* Age play
? Role playing different ages (all participants adult).

#Pain
(Giving, Receiving)
* Light pain
? Mild physical discomfort for sexual enhancement.
* Heavy pain
? Intense physical discomfort for sexual enhancement.
* Nipple clamps
? Devices that apply pressure to nipples.
* Clothes pins
? Using clothespins to pinch skin.
* Caning
? Striking with a flexible cane.
* Flogging
? Striking with whips, floggers, or similar implements.
* Gagging / Choking
? Restricting breathing or causing gag reflex.
* Beating
? Striking with fists or objects.
* Spanking
? Striking the buttocks for sexual pleasure.
* Cock/Pussy slapping
? Striking genitalia for sexual stimulation.
* Cock/Pussy torture
? Causing pain to genitalia for sexual purposes.
* Hot Wax
? Using heated wax for sexual stimulation.
* Scratching
? Using nails or claws to mark skin.
* Biting
? Using teeth to cause sensation or pain.
* Cutting
? Making small cuts for sexual purposes.
* Needle play
? Using needles for sensation or pain.

#Meta
(Self, Partner)
* First Person
* Third Person
* Short Post Length (~1-3 sentences)
* Medium Post Length (~3-7 sentences)
* Long Post Length (~2-4 paragraphs)
* Story (3+ paragraphs)
* Dynamic Post Length

#Surrealism
(Self, Partner)
* Futanari/Futa
? characters who have an overall feminine body, but have both female and male genitalia (although testicles are not always present)
* Furry
? Anthropomorphic animal characters.
* Vore
? The act of physically consuming another character
* Transformation
? The act of causing the physical characteristics of a participant of an RP, possibly including one's self, by magical or chemical means, to change in a dramatic fashion; may refer to a myriad of different types of transformations, and connotates receiving sexual pleasure from the act of transformation itself.
* Tentacles
? Engaging in an RP in which self-sentient tentacles or tentacle-like appendages will penetrate a character; often implies multiple penetration.
* Monster or Alien
? Various types of monsters, Extraterrestrials, and aesthetically challenging characters.
* Ghost
? The formerly living, not currently in posession of a body
* Shapeshifting
? Characters with the ability to change their physical form at will, including species, gender, or body parts.
* Size Play (Macro/Micro)
? Scenarios involving dramatic size differences between characters, from giant to tiny proportions.
* Multiple Limbs
? Characters with additional arms, legs, or other appendages beyond normal human anatomy.
* Elemental Beings
? Characters made of or controlling elements like fire, water, earth, air, or other natural forces.
* Cyborgs/Androids
? Characters that are part machine, artificial intelligence, or robotic beings with human-like qualities.
* Vampires/Supernatural
? Immortal beings, vampires, werewolves, and other classic supernatural creatures.
* Mythical Creatures
? Dragons, phoenixes, unicorns, and other creatures from mythology and fantasy.
* Plant/Nature Beings
? Characters that are plant-based, tree-like, or have botanical characteristics.
* Energy Beings
? Characters made of pure energy, light, or other non-physical substances.

#Medium
(General)
* Skype
* Kik
* Reddit
* E-Mail
* Discord
* Other
* Telegram
? Secure messaging platform with advanced features for private communication.
* WhatsApp
? Popular mobile messaging application for text and voice communication.
* Signal
? Privacy-focused messaging app with end-to-end encryption.
* Steam
? Gaming platform with built-in messaging and chat features.
* Twitter/X DMs
? Direct messaging through Twitter/X social media platform.
* Instagram DMs
? Direct messaging through Instagram social media platform.
* Snapchat
? Mobile app focused on disappearing messages and multimedia sharing.
* Facebook Messenger
? Facebook's dedicated messaging platform for text and video communication.
* Forums/Boards
? Traditional forum-style communication with threaded discussions.
* Custom Platforms
? Specialized roleplay websites and custom communication tools.

#Time-Scale
(Self, Partner)
* Short-Term Scenes
* Medium-Term Scenes
* Long-Term Scenes
* Ultra-Quick Replies (0~5 mins)
? Immediate responses expected within minutes for rapid-fire roleplay.
* Quick Replies (0~10 mins)
* Fast Replies (10~30 mins)
* Normal Replies (30min ~ 2hours)
* Slow Replies (2~8 hours)
* Glacial Replies (8-24 hours)
* Occasional Replies (24+ hours)
* Weekly Replies (1~7 days)
? Responses expected within a week, suitable for detailed, thoughtful posts.
* Monthly Replies (Weeks to months)
? Very slow-paced roleplay with responses every few weeks to months.
* Seasonal Replies (Months between)
? Extremely slow-paced with responses separated by months, for epic long-term stories.
* Real-time Sessions
? Live, synchronous roleplay sessions with immediate back-and-forth interaction.
* Flexible Timing
? No set expectations, responses when convenient for both parties.`
        };

        // Parse kinklist data
        function parseKinkListData(data) {
            const lines = data.split('\n').filter(line => line.trim());
            const categories = [];
            let currentCategory = null;
            let currentSubcategory = undefined;

            for (const line of lines) {
                if (line.startsWith('#')) {
                    const categoryName = line.substring(1).trim();
                    currentCategory = {
                        name: categoryName,
                        items: []
                    };
                    categories.push(currentCategory);
                    currentSubcategory = undefined;
                } else if (line.startsWith('(') && line.endsWith(')')) {
                    const subcategoryText = line.substring(1, line.length - 1);
                    currentSubcategory = subcategoryText;
                    if (currentCategory) {
                        currentCategory.subcategory = subcategoryText;
                    }
                } else if (line.startsWith('* ')) {
                    const itemName = line.substring(2).trim();
                    if (currentCategory) {
                        const isDualPreference = currentSubcategory && (
                            currentSubcategory.includes('Giving, Receiving') ||
                            currentSubcategory.includes('As Dominant, As Submissive') ||
                            currentSubcategory.includes('Actor, Subject') ||
                            currentSubcategory.includes('Aggressor, Target') ||
                            currentSubcategory.includes('Self, Partner') ||
                            currentSubcategory.includes('Small, Large')
                        );

                        let dualLabels;
                        if (isDualPreference) {
                            if (currentSubcategory?.includes('Giving, Receiving')) {
                                dualLabels = { first: 'Giving', second: 'Receiving' };
                            } else if (currentSubcategory?.includes('As Dominant, As Submissive')) {
                                dualLabels = { first: 'As Dominant', second: 'As Submissive' };
                            } else if (currentSubcategory?.includes('Actor, Subject')) {
                                dualLabels = { first: 'As Actor', second: 'As Subject' };
                            } else if (currentSubcategory?.includes('Aggressor, Target')) {
                                dualLabels = { first: 'As Aggressor', second: 'As Target' };
                            } else if (currentSubcategory?.includes('Self, Partner')) {
                                dualLabels = { first: 'For Self', second: 'For Partner' };
                            } else if (currentSubcategory?.includes('Small, Large')) {
                                dualLabels = { first: 'Small', second: 'Large' };
                            }
                        }

                        currentCategory.items.push({
                            name: itemName,
                            category: currentCategory.name,
                            subcategory: currentSubcategory,
                            hasDualPreference: isDualPreference,
                            dualLabels
                        });
                    }
                } else if (line.startsWith('? ')) {
                    const description = line.substring(2).trim();
                    if (currentCategory && currentCategory.items.length > 0) {
                        const lastItem = currentCategory.items[currentCategory.items.length - 1];
                        lastItem.description = description;
                    }
                }
            }

            return categories;
        }

        // Theme management
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            
            if (body.classList.contains('dark')) {
                body.classList.remove('dark');
                themeIcon.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.add('dark');
                themeIcon.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Initialize theme
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.body.classList.add('dark');
                document.getElementById('theme-icon').textContent = '☀️';
            }
        }

        // Page navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');
        }

        function showListSelection() {
            showPage('list-selection');
        }

        function showKinklist() {
            showPage('kinklist-page');
        }

        function showCompletion() {
            updateCompletionStats();
            showPage('completion-page');
        }

        // List type selection
        function selectListType(type) {
            currentListType = type;
            
            // Update active button
            document.querySelectorAll('.list-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Parse and load data
            kinkData = parseKinkListData(kinklistData[type]);
            renderKinklist();
            showKinklist();
        }

        // Preference management
        function setPreference(itemName, level, isDual = false, dualType = null) {
            if (!preferences[itemName]) {
                preferences[itemName] = {
                    itemName,
                    level: 'not-entered'
                };
            }

            if (isDual && dualType) {
                preferences[itemName].dualLevel = level;
            } else {
                preferences[itemName].level = level;
            }

            // Save to localStorage
            localStorage.setItem('kinklist-preferences', JSON.stringify(preferences));
            
            // Update UI
            updateProgress();
            updatePreferenceButton(itemName, level, isDual, dualType);
        }

        function updatePreferenceButton(itemName, level, isDual, dualType) {
            const selector = isDual ? 
                `[data-item="${itemName}"][data-dual="${dualType}"]` : 
                `[data-item="${itemName}"]:not([data-dual])`;
            
            const buttons = document.querySelectorAll(`${selector} .pref-btn`);
            buttons.forEach(btn => btn.classList.remove('active'));
            
            const activeButton = document.querySelector(`${selector} .pref-btn[data-level="${level}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }

        // Progress tracking
        function updateProgress() {
            const totalItems = kinkData.reduce((sum, category) => sum + category.items.length, 0);
            const completedItems = Object.keys(preferences).length;
            const percentage = totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;

            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('completed-items').textContent = completedItems;
            document.getElementById('completion-percentage').textContent = `${percentage}%`;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
        }

        // Render kinklist
        function renderKinklist() {
            const container = document.getElementById('categories-container');
            container.innerHTML = '';

            kinkData.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';

                const explanation = categoryExplanations[category.name] || '';
                
                categoryDiv.innerHTML = `
                    <div class="category-header">
                        <h2 class="category-title">${category.name}</h2>
                        ${explanation ? `<p class="category-description">${explanation}</p>` : ''}
                        ${category.subcategory ? `<p class="subcategory-title">${category.subcategory}</p>` : ''}
                    </div>
                    <div class="items-grid">
                        ${category.items.map(item => renderKinkItem(item)).join('')}
                    </div>
                `;

                container.appendChild(categoryDiv);
            });

            // Add event listeners
            addPreferenceListeners();
            updateProgress();
        }

        function renderKinkItem(item) {
            const preference = preferences[item.name];
            
            if (item.hasDualPreference && item.dualLabels) {
                return `
                    <div class="kink-item">
                        <div class="item-name">${item.name}</div>
                        ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                        <div class="dual-preferences">
                            <div>
                                <div class="dual-label">${item.dualLabels.first}</div>
                                <div class="preference-buttons" data-item="${item.name}" data-dual="first">
                                    ${renderPreferenceButtons(preference?.level)}
                                </div>
                            </div>
                            <div>
                                <div class="dual-label">${item.dualLabels.second}</div>
                                <div class="preference-buttons" data-item="${item.name}" data-dual="second">
                                    ${renderPreferenceButtons(preference?.dualLevel)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                return `
                    <div class="kink-item">
                        <div class="item-name">${item.name}</div>
                        ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                        <div class="preference-buttons" data-item="${item.name}">
                            ${renderPreferenceButtons(preference?.level)}
                        </div>
                    </div>
                `;
            }
        }

        function renderPreferenceButtons(currentLevel) {
            const levels = ['favorite', 'like', 'indifferent', 'maybe', 'limit'];
            return levels.map(level => `
                <button class="pref-btn pref-${level} ${currentLevel === level ? 'active' : ''}" 
                        data-level="${level}" 
                        title="${level.charAt(0).toUpperCase() + level.slice(1)}">
                    ${level.charAt(0).toUpperCase()}
                </button>
            `).join('');
        }

        function addPreferenceListeners() {
            document.querySelectorAll('.pref-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const level = e.target.dataset.level;
                    const container = e.target.closest('.preference-buttons');
                    const itemName = container.dataset.item;
                    const dualType = container.dataset.dual;
                    
                    setPreference(itemName, level, !!dualType, dualType);
                });
            });
        }

        // Reset functionality
        function resetAll() {
            if (confirm('Are you sure you want to reset all preferences?')) {
                preferences = {};
                localStorage.removeItem('kinklist-preferences');
                renderKinklist();
            }
        }

        // Import/Export functionality
        function importPreferences(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.preferences && data.listType) {
                        preferences = data.preferences;
                        currentListType = data.listType;
                        
                        // Update UI
                        document.querySelectorAll('.list-type-btn').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        
                        kinkData = parseKinkListData(kinklistData[currentListType]);
                        renderKinklist();
                        showKinklist();
                        
                        alert('Preferences imported successfully!');
                    } else {
                        alert('Invalid file format');
                    }
                } catch (error) {
                    alert('Error reading file: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function exportAsJSON() {
            const exportData = {
                listType: currentListType,
                preferences: preferences,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kinklist-${currentListType}-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function exportAsHTML() {
            const htmlContent = generateHTMLExport();
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kinklist-${currentListType}-${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generateHTMLExport() {
            const stats = calculateStats();
            
            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Kinklist - ${currentListType.charAt(0).toUpperCase() + currentListType.slice(1)}</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 40px; padding: 40px; background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; border-radius: 16px; }
        .stats { display: flex; gap: 20px; margin: 30px 0; justify-content: center; flex-wrap: wrap; }
        .stat { text-align: center; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .stat-number { font-size: 2rem; font-weight: bold; color: #333; }
        .stat-label { color: #666; margin-top: 5px; }
        .category { margin: 30px 0; background: white; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .category-title { font-size: 1.5rem; font-weight: 600; margin-bottom: 20px; color: #333; }
        .items-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        .item { padding: 16px; border-radius: 8px; border-left: 4px solid #ddd; }
        .item-name { font-weight: 500; margin-bottom: 8px; }
        .item-description { font-size: 0.9rem; color: #666; margin-bottom: 12px; }
        .preference { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; margin: 2px; }
        .pref-favorite { background: #3b82f6; color: white; }
        .pref-like { background: #10b981; color: white; }
        .pref-indifferent { background: #f59e0b; color: white; }
        .pref-maybe { background: #f97316; color: white; }
        .pref-limit { background: #dc2626; color: white; }
        .dual-prefs { display: flex; gap: 10px; flex-wrap: wrap; }
        .dual-label { font-size: 0.8rem; color: #666; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>My Kinklist</h1>
            <p>${currentListType.charAt(0).toUpperCase() + currentListType.slice(1)} Version - Generated on ${new Date().toLocaleDateString()}</p>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-number">${stats.total}</div>
                <div class="stat-label">Total Items</div>
            </div>
            <div class="stat">
                <div class="stat-number">${stats.completed}</div>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat">
                <div class="stat-number">${stats.favorite}</div>
                <div class="stat-label">Favorites</div>
            </div>
            <div class="stat">
                <div class="stat-number">${stats.like}</div>
                <div class="stat-label">Likes</div>
            </div>
            <div class="stat">
                <div class="stat-number">${stats.limit}</div>
                <div class="stat-label">Limits</div>
            </div>
        </div>
        
        ${kinkData.map(category => `
            <div class="category">
                <h2 class="category-title">${category.name}</h2>
                <div class="items-grid">
                    ${category.items.filter(item => preferences[item.name]).map(item => {
                        const pref = preferences[item.name];
                        return `
                            <div class="item">
                                <div class="item-name">${item.name}</div>
                                ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                                ${item.hasDualPreference && item.dualLabels ? `
                                    <div class="dual-prefs">
                                        <div>
                                            <span class="dual-label">${item.dualLabels.first}:</span>
                                            <span class="preference pref-${pref.level}">${pref.level.charAt(0).toUpperCase() + pref.level.slice(1)}</span>
                                        </div>
                                        ${pref.dualLevel ? `
                                            <div>
                                                <span class="dual-label">${item.dualLabels.second}:</span>
                                                <span class="preference pref-${pref.dualLevel}">${pref.dualLevel.charAt(0).toUpperCase() + pref.dualLevel.slice(1)}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                ` : `
                                    <span class="preference pref-${pref.level}">${pref.level.charAt(0).toUpperCase() + pref.level.slice(1)}</span>
                                `}
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>
        `).join('')}
    </div>
</body>
</html>`;
        }

        function calculateStats() {
            const totalItems = kinkData.reduce((sum, category) => sum + category.items.length, 0);
            const completed = Object.keys(preferences).length;
            
            const stats = {
                total: totalItems,
                completed: completed,
                favorite: 0,
                like: 0,
                indifferent: 0,
                maybe: 0,
                limit: 0
            };

            Object.values(preferences).forEach(pref => {
                if (stats.hasOwnProperty(pref.level)) {
                    stats[pref.level]++;
                }
                if (pref.dualLevel && stats.hasOwnProperty(pref.dualLevel)) {
                    stats[pref.dualLevel]++;
                }
            });

            return stats;
        }

        function updateCompletionStats() {
            const stats = calculateStats();
            const container = document.getElementById('completion-stats');
            
            container.innerHTML = `
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number">${stats.total}</div>
                        <div class="stat-label">Total Items</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${stats.completed}</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${stats.favorite}</div>
                        <div class="stat-label">Favorites</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${stats.like}</div>
                        <div class="stat-label">Likes</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${stats.limit}</div>
                        <div class="stat-label">Limits</div>
                    </div>
                </div>
            `;
        }

        // Initialize app
        function init() {
            initTheme();
            
            // Load saved preferences
            const saved = localStorage.getItem('kinklist-preferences');
            if (saved) {
                try {
                    preferences = JSON.parse(saved);
                } catch (error) {
                    console.error('Failed to load preferences:', error);
                }
            }
        }

        // Start the app
        init();
    </script>
</body>
</html>
